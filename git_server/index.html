<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://cryxtalix.github.io/NixOS-config/git_server/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Running an SSH git server - NixOS configuration docs</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Running an SSH git server";
        var mkdocs_page_input_path = "git_server.md";
        var mkdocs_page_url = "/NixOS-config/git_server/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> NixOS configuration docs
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../code_doc/">Code documentation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../bash_aliases/">Bash aliases</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../installing_nix_pm/">Installing nix package manager</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Running an SSH git server</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#initial-nix-setup">Initial nix setup</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#managing-repositories">Managing repositories</a>
    </li>
    </ul>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">NixOS configuration docs</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Running an SSH git server</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="ssh-git-server">SSH Git Server</h1>
<h2 id="initial-nix-setup">Initial nix setup</h2>
<p>To run a simple SSH git server, import /modules/git-daemon.nix in your system host of choice. Add a public SSH key for use with the git server into the keys folder, and edit the git-daemon.nix file with the reference to your new public key file. Run the rebuild command.</p>
<h2 id="managing-repositories">Managing repositories</h2>
<p>Repositories are stored in the /srv/git folder, which is owned exclusively by the git user. No other user accounts can access that folder, while the git user does not provide any shell access. We do not want users of the git server to make any changes to the server. Therefore we have to use the root account to add/remove repositories.</p>
<p>To add a new repository, login to the root user with <code>sudo -i</code> or <code>sudo su</code>. Go to /srv/git and run <code>git init --bare myProject.git</code> to create a blank repo with the same name as your project. The myProject.git folder and all the files within are currently owned by root and cannot be accessed by the git user, so we run <code>chown -R git:git myProject.git/</code> to change ownership to the git user.</p>
<p>Back in our project folder, add a new git remote by running <code>git remote add home git@[server_ip]:/srv/git/myProject.git</code>, where "home" is the name we choose for this remote. Alternatively, we can edit the .git/config file inside the project folder.</p>
<p>Finally, run <code>git push home [branch_name]</code> and the project will be pushed to the git server.</p>
<p>To remove a repository, simply delete the myProject.git folder at /srv/git as root.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../installing_nix_pm/" class="btn btn-neutral float-left" title="Installing nix package manager"><span class="icon icon-circle-arrow-left"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../installing_nix_pm/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
